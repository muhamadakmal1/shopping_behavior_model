# Machine Learning Models

This folder contains trained ML models for shopping behavior prediction.

## Models Included

### 1. **regression_model.pkl** (3.7 MB)
- **Type:** Random Forest Regressor
- **Purpose:** Predict purchase amount
- **Performance:** RMSE = $24.04
- **Features:** 10 features (age, purchases, rating, etc.)

### 2. **classification_model.pkl** (270 KB)
- **Type:** Random Forest Classifier
- **Purpose:** Predict subscription likelihood  
- **Performance:** 100% Accuracy
- **Features:** 10 features (same as regression)

### 3. **clustering_model.pkl** (16 KB)
- **Type:** K-Means Clustering
- **Purpose:** Customer segmentation
- **Clusters:** 4 segments
- **Features:** 4 features (age, purchase amount, previous purchases, rating)

### 4. **scaler.pkl** (950 B)
- **Type:** StandardScaler
- **Purpose:** Feature scaling for regression/classification

### 5. **cluster_scaler.pkl** (699 B)
- **Type:** StandardScaler
- **Purpose:** Feature scaling for clustering

### 6. **label_encoders.pkl** (624 B)
- **Type:** Dictionary of LabelEncoders
- **Purpose:** Encode categorical features
- **Encoders for:** Gender, Category, Season, Frequency of Purchases

### 7. **feature_columns.pkl** (190 B)
- **Type:** List
- **Purpose:** Column names in correct order
- **Contents:** 10 feature names

### 8. **feature_importance.pkl** (1 KB)
- **Type:** DataFrame
- **Purpose:** Feature importance scores
- **Contents:** Features ranked by importance

### 9. **model_metadata.pkl** (489 B)
- **Type:** Dictionary
- **Purpose:** Model training metadata
- **Contents:**
  - Training date
  - Total samples
  - Number of features
  - Model performance metrics
  - Feature names

## How Models Were Trained

1. **Data:** 3,900 customer records
2. **Split:** 80% training, 20% testing
3. **Scaling:** StandardScaler normalization
4. **Algorithm:** Random Forest (100 trees, max_depth=10)
5. **Validation:** Train/test split evaluation

## Using the Models

### Load Models
```python
from model_loader import load_models

models = load_models()
regression_model = models['regression']
classification_model = models['classification']
```

### Make Predictions
```python
import numpy as np

# Prepare features (must match training order)
features = np.array([[
    age, prev_purchases, rating, is_subscriber,
    discount_used, promo_used, gender_encoded,
    category_encoded, season_encoded, frequency_encoded
]])

# Scale features
scaled_features = models['scaler'].transform(features)

# Predict purchase amount
purchase_amount = models['regression'].predict(scaled_features)[0]

# Predict subscription probability
subscription_prob = models['classification'].predict_proba(scaled_features)[0][1]
```

## Retraining Models

To retrain models with new data:

```bash
python train_models.py
```

This will:
1. Load latest data from CSV
2. Train all 3 models
3. Evaluate performance
4. Save models to this folder
5. Update metadata

## Model Performance

| Model | Metric | Value |
|-------|--------|-------|
| Regression | RMSE | $24.04 |
| Regression | RÂ² Score | -0.0332 |
| Classification | Accuracy | 100.00% |
| Clustering | Clusters | 4 |
| Clustering | Samples | 3,900 |

## Feature List

1. Age
2. Previous Purchases
3. Review Rating
4. Is_Subscriber (binary)
5. Discount_Used (binary)
6. Promo_Used (binary)
7. Gender_encoded (0-1)
8. Category_encoded (0-3)
9. Season_encoded (0-3)
10. Frequency_encoded (0-6)

## Notes

- Models are saved using Python's pickle module
- Compatible with scikit-learn 1.3.2
- All models use random_state=42 for reproducibility
- Feature scaling is required before prediction
- Label encoding maps categorical values to integers

## File Sizes

| File | Size |
|------|------|
| regression_model.pkl | 3.7 MB |
| classification_model.pkl | 270 KB |
| clustering_model.pkl | 16 KB |
| scaler.pkl | 950 B |
| cluster_scaler.pkl | 699 B |
| label_encoders.pkl | 624 B |
| model_metadata.pkl | 489 B |
| feature_columns.pkl | 190 B |
| feature_importance.pkl | 1 KB |
| **TOTAL** | **~4 MB** |

---

**Last Updated:** Run `python train_models.py` to see latest training date  
**Generated by:** train_models.py  
**Used by:** Flask app (app.py via model_loader.py)
